<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advice Results</title>
    <link rel="stylesheet" href="/static/styles.css">
    <style>
        #redirect-button {
            display: inline-block;
            margin-top: -8px;
            margin-left: 20px;
            font-size: 1em;
            height: 40px;
            width: 100px;
            cursor: pointer;
            border: ed;
            border-radius: 8px;
            background-color: red;
            color: white;
            transition: background-color 0.3s;
            vertical-align: top;
        }

        #redirect-button.autoFitButton {
            width: auto;
            display: inline-block;
            padding: 10px; 
            margin-top: -8px;
            margin-left: 20px;
        }

        #redirect-button:hover {
            background-color: white;
            color: red;
        }

        /* map styles */
        #map {
            width: 100%;
            height: 300px;
            margin-top: 20px;
        }
    </style>

    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <script>
        // Now we show the cities advised by us
        $(document).ready(function () {
            var currentIndex = 0;

            function showNextCities() {
                currentIndex += 5;
                $.ajax({
                    url: '/load-more-cities',
                    type: 'POST',
                    data: { index: currentIndex },
                    success: function (data) {
                        if (data.message === 'Success') {
                            for (var i = 0; i < data.cities.length; i++) {
                                $('#cities-list').append('<li>' + data.cities[i] + '</li>');
                            }
                        } else {
                            $('#load-more-button').hide();  // Hide the button if no more cities are available
                        }
                    },
                    error: function () {
                        console.log('Error loading more cities');
                    }
                });
            }

            $('#load-more-button').on('click', function () {
                showNextCities();
            });

            // Now if the user know where to go can plan the trip with us!
            $('#redirect-button').on('click', function () {
                window.location.href = '/trip-planner-yes';
            });

            // Call initMap when the page loads
            initMap();
        });
    </script>
</head>

<body>
    <h2>Advice Results for {{ username }}</h2>

    {% if cities %}
        <h3>Recommended Cities:</h3>
        <ul id="cities-list">
            {% for city in cities[:5] %}
                <li>{{ city }}</li>
            {% endfor %}
        </ul>
        <button id="load-more-button">Load More</button>

        <button id="redirect-button">Go to Trip Planner</button>

    {% else %}
        <p>No cities available</p>
    {% endif %}

    <div id="map"></div>

    <script>
        function initMap() {
            // Initialize the map centered at Rome
            var map = new google.maps.Map(document.getElementById("map"), {
                center: { lat: 41.9028, lng: 12.4964 }, // Coordinates for Rome (Caput Mundi ;) )
                zoom: 4.5
            });

            // Some Capital coordinates (latitude and longitude)
            var capitals = [
                    { name: 'Tokyo', lat: 35.689487, lng: 139.691711 },
                    { name: 'Beijing', lat: 39.9042, lng: 116.4074 },
                    { name: 'Bangkok', lat: 13.7563, lng: 100.5018 },
                    { name: 'Mumbai', lat: 19.0760, lng: 72.8777 },
                    { name: 'Istanbul', lat: 41.0082, lng: 28.9784 },
                    { name: 'Lahore', lat: 31.5497, lng: 74.3436 },
                    { name: 'Kinshasa', lat: -4.4419, lng: 15.2663 },
                    { name: 'Lima', lat: -12.0464, lng: -77.0428 },
                    { name: 'Bangalore', lat: 12.9716, lng: 77.5946 },
                    { name: 'London', lat: 51.509865, lng: -0.118092 },
                    { name: 'Paris', lat: 48.856613, lng: 2.352222 },
                    { name: 'Berlin', lat: 52.5200, lng: 13.4050 },
                    { name: 'Rome', lat: 41.9028, lng: 12.4964 },
                    { name: 'New York City', lat: 40.7128, lng: -74.0060 },
                    { name: 'Los Angeles', lat: 34.0522, lng: -118.2437 },
                    { name: 'Rio de Janeiro', lat: -22.9068, lng: -43.1729 },
                    { name: 'Cape Town', lat: -33.9249, lng: 18.4241 },
                    { name: 'Sydney', lat: -33.8688, lng: 151.2093 },
                    { name: 'Toronto', lat: 43.6532, lng: -79.3832 },
                    { name: 'Mexico City', lat: 19.4326, lng: -99.1332 },
                    { name: 'Buenos Aires', lat: -34.6037, lng: -58.3816 },
                    { name: 'Nairobi', lat: -1.286389, lng: 36.817223 },
                    { name: 'Cairo', lat: 30.0444, lng: 31.2357 },
                    { name: 'Marrakech', lat: 31.6295, lng: -7.9811 },
                    { name: 'Amsterdam', lat: 52.3676, lng: 4.9041 },
                    { name: 'Moscow', lat: 55.7558, lng: 37.6176 },
                    { name: 'Seoul', lat: 37.5665, lng: 126.9780 },
                    { name: 'Hong Kong', lat: 22.3193, lng: 114.1694 },
                    { name: 'Singapore', lat: 1.3521, lng: 103.8198 },
                    { name: 'Dubai', lat: 25.276987, lng: 55.296249 },
                    { name: 'Stockholm', lat: 59.3293, lng: 18.0686 },
                    { name: 'Oslo', lat: 59.9139, lng: 10.7522 },
                    { name: 'Copenhagen', lat: 55.6761, lng: 12.5683 },
                    { name: 'Berlin', lat: 52.5200, lng: 13.4050 },
                    { name: 'Vienna', lat: 48.8566, lng: 2.3522 },
                    { name: 'Prague', lat: 50.0755, lng: 14.4378 },
                    { name: 'Warsaw', lat: 52.2297, lng: 21.0122 },
                    { name: 'Budapest', lat: 47.4979, lng: 19.0402 },
                    { name: 'Athens', lat: 37.9838, lng: 23.7275 },
                    { name: 'Istanbul', lat: 41.0082, lng: 28.9784 },
                    { name: 'Jerusalem', lat: 31.7683, lng: 35.2137 },
                    { name: 'Cape Town', lat: -33.9249, lng: 18.4241 },
                    { name: 'Nairobi', lat: -1.286389, lng: 36.817223 },
                    { name: 'Addis Ababa', lat: 9.1450, lng: 40.4897 },
                    { name: 'Cairo', lat: 30.0444, lng: 31.2357 },
                    { name: 'Casablanca', lat: 33.5731, lng: -7.5898 },
                    { name: 'Tehran', lat: 35.6895, lng: 51.3890 },
                    { name: 'Baghdad', lat: 33.3152, lng: 44.3661 },
                    { name: 'Riyadh', lat: 24.7136, lng: 46.6753 },
                ]


            // Add markers for each capital
            for (var i = 0; i < capitals.length; i++) {
                var capital = capitals[i];
                var marker = new google.maps.Marker({
                    position: { lat: capital.lat, lng: capital.lng },
                    map: map,
                    title: capital.name
                });
            }
        }
        // Yes, we would like to address the map for our destinations, but we do not have lat and long  for each city in our database (4000+)
    </script>

    <!-- Google Maps API script -->
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB-TLHALRPRztYkWv2yes8lNVZYs6Kek0o&callback=initMap"></script>
</body>

</html>
